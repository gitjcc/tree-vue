<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>tree-title</title>
    <link rel="stylesheet" href="../dist/font-awesome-4.7.0/css/font-awesome.css">
    <link rel="stylesheet" href="../dist/css/x-tree-vue.css">
    <script src="../dist/lib/vue.js"></script>
    <script src="../dist/tree.js"></script>
</head>
<body>
<div id="xTreeDemo">
    <x-tree :data="data" :options="options"></x-tree>
</div>

<div class="button button-edit">edit</div>
<div class="button button-add">add</div>
<div class="button button-cancel">cancel</div>

<div>footer</div>

<script>
    var treeOptions = {
        only_child: false,
        is_multi: true,
        is_trigger: false,
        node_merge: false,
        has_search: false,
        sel_ids: '3,11,12,13,30,31,32,33',
        expand: 6,
        onName: function (item) {
            console.log("click item", item, item.name);
        },
        onEdit: function (item) {
            console.log("edit item", item, item.name);
            popUpEditor(item);
        },

        onDelete: function (item) {
            console.log("delete item", item, item.name, "item.parent", item.parent);
        },

        onAddChild: function (newChild) {
            console.log("add child, parent is", newChild.parent, newChild.parent.name);
            popUpAddor(newChild);
        },
    };

    var treeData = [
        {id: 26, name: '成都', nodeId: 7, is_node: false, is_check: false},
        {id: 27, name: '泸州', nodeId: 7, is_node: false, is_check: false},
        {id: 28, name: '昆明', nodeId: 7, is_node: false, is_check: false},
        {id: 29, name: '大理', nodeId: 7, is_node: true, is_check: false},
        {id: 30, name: '贵阳', nodeId: 29, is_node: false, is_check: false},
        {id: 31, name: '遵义', nodeId: 29, is_node: false, is_check: false},
        {id: 32, name: '南宁', nodeId: 29, is_node: false, is_check: false},
        {id: 33, name: '桂林', nodeId: 29, is_node: false, is_check: false},

        {id: 1, name: '中国', nodeId: 99, is_node: true, is_check: false},
        {id: 110, name: '大陆', nodeId: 99, is_node: true, is_check: false},
        {id: 111, name: '大陆', nodeId: 110, is_node: false, is_check: false},

        {id: 2, name: '四川', nodeId: 1, is_node: true, is_check: false},
        {id: 3, name: '云南', nodeId: 1, is_node: true, is_check: false},
        {id: 4, name: '贵州', nodeId: 1, is_node: true, is_check: false},
        {id: 5, name: '广西', nodeId: 1, is_node: true, is_check: false},
        {id: 6, name: '成都', nodeId: 2, is_node: false, is_check: false},
        {id: 7, name: '泸州', nodeId: 2, is_node: true, is_check: false},
        {id: 8, name: '昆明', nodeId: 3, is_node: false, is_check: false},
        {id: 9, name: '大理', nodeId: 3, is_node: false, is_check: false},
        {id: 10, name: '贵阳', nodeId: 4, is_node: false, is_check: false},
        {id: 11, name: '遵义', nodeId: 4, is_node: false, is_check: false},
        {id: 12, name: '南宁', nodeId: 5, is_node: false, is_check: false},
        {id: 13, name: '桂林', nodeId: 5, is_node: false, is_check: false},
    ];

    var xTree1 = new Vue({
        el: '#xTreeDemo',
        data: function () {
            return {
                data: treeData,
                options: treeOptions,
            };
        }
    });
    console.log("new Vue(), xTree1 is ", xTree1);

// editItem
    var editTemp = {};
    function popUpEditor(item) {
        editTemp = item;
    }
    function editItem() {
        console.log("editTempBefore", editTemp, editTemp.name);
        editTemp.id = 666;
        editTemp.name = "edit";
        editTemp.is_check = false;
        editTemp.is_node = true;
        console.log("editTempAfter", editTemp, editTemp.name);
        editTemp = {};
    }
    var editEl = document.querySelector('.button-edit');
    editEl.addEventListener('click', editItem);

// addChild()
    var addTemp = {};
    function popUpAddor(item) {
        addTemp = item;
    }
    function addItem() {
        console.log("addTempBefore", addTemp, addTemp.name);
        addTemp.id = 777;
        addTemp.name = "add";
        addTemp.is_check = true;
        addTemp.is_node = false;

        if (!addTemp.parent.is_node) {
            addTemp.parent.is_node = true;
            addTemp.parent.children = [];
        }
        addTemp.parent.expand = true;
        addTemp.parent.children.push(addTemp);
        console.log("addTempAfter", addTemp, addTemp.name);
        addTemp = {};
    }
    function cancelAdd() {
        console.log("add cancel");
    }
    var addEl = document.querySelector('.button-add');
    addEl.addEventListener('click', addItem);

    var cancelEl = document.querySelector('.button-cancel');
    cancelEl.addEventListener('click', cancelAdd);
</script>

</body>
</html>